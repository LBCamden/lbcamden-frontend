!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("govuk-frontend/govuk/vendor/polyfills/Event.mjs"),require("govuk-frontend/govuk/vendor/polyfills/Function/prototype/bind.mjs")):"function"==typeof define&&define.amd?define("LBCamdenFrontend",["exports","govuk-frontend/govuk/vendor/polyfills/Event.mjs","govuk-frontend/govuk/vendor/polyfills/Function/prototype/bind.mjs"],t):t(e.LBCamdenFrontend={})}(this,function(e){"use strict";function t(e,t){if(window.NodeList.prototype.forEach)return e.forEach(t);for(var n=0;n<e.length;n++)t.call(window,e[n],n,e)}const n={minWidth:"40.0625em",desktop:"48em"};function i(e){this.$module=e,this.debounceFormSubmitTimer=null}function o(e){this.$module=e,this.$navigationToggle=this.$module.querySelector("#super-navigation-menu-toggle"),this.$navigationMenu=this.$module.querySelector("#super-navigation-menu"),this.$searchToggle=this.$module.querySelector("#super-search-menu-toggle"),this.$searchMenu=this.$module.querySelector("#super-search-menu"),this.$buttons=this.$module.querySelectorAll("button[aria-controls][data-toggle-mobile-group][data-toggle-desktop-group]"),this.$menuButtons=this.$module.querySelectorAll(".lbcamden-header__navigation-item--with-children"),this.$phaseBanner=document.querySelector(".govuk-phase-banner"),this.$header=document.querySelector(".lbcamden-header"),this.hiddenButtons=this.$module.querySelectorAll("button[hidden]"),this.menuOpen=!1,this.searchOpen=!1,this.lastWindowSize=null}i.prototype.handleKeyDown=function(e){var t=e.target;"button"===t.getAttribute("role")&&32===e.keyCode&&(e.preventDefault(),t.click())},i.prototype.debounce=function(e){var t=e.target;if("true"===t.getAttribute("data-prevent-double-click"))return this.debounceFormSubmitTimer?(e.preventDefault(),!1):void(this.debounceFormSubmitTimer=setTimeout(function(){this.debounceFormSubmitTimer=null}.bind(this),1e3))},i.prototype.init=function(){this.$module.addEventListener("keydown",this.handleKeyDown),this.$module.addEventListener("click",this.debounce)},o.prototype.init=function(){this.$module&&(this.$module.classList.add("js-module-initialised"),"function"==typeof window.matchMedia&&this.setupResponsiveChecks())},o.prototype.setupResponsiveChecks=function(){this.mql=window.matchMedia("(min-width: "+n.desktop+")"),this.mql.addListener(this.checkMode.bind(this)),this.checkMode()},o.prototype.checkMode=function(){this.mql.matches?(this.teardownMobileMenu(),this.setupDesktopMenu()):(this.teardownDesktopMenu(),this.setupMobileMenu())},o.prototype.setupMobileMenu=function(){this.setAttributes("mobile"),null!=this.$navigationMenu&&(this.$navigationToggle.boundMenuClick=this.handleMenuButtonClick.bind(this),this.$navigationToggle.addEventListener("click",this.$navigationToggle.boundMenuClick,!0)),null!=this.$searchMenu&&(this.$searchToggle.boundSearchClick=this.handleSearchButtonClick.bind(this),this.$searchToggle.addEventListener("click",this.$searchToggle.boundSearchClick,!0))},o.prototype.teardownMobileMenu=function(){this.unsetAttributes("mobile"),null!=this.$navigationMenu&&this.$navigationToggle.removeEventListener("click",this.$navigationToggle.boundMenuClick,!0),null!=this.$searchMenu&&this.$searchToggle.removeEventListener("click",this.$searchToggle.boundSearchClick,!0)},o.prototype.setupDesktopMenu=function(){this.setAttributes("desktop"),null!=this.$searchMenu&&(this.$searchToggle.boundSearchClick=this.handleSearchButtonClick.bind(this),this.$searchToggle.addEventListener("click",this.$searchToggle.boundSearchClick,!0))},o.prototype.teardownDesktopMenu=function(){this.unsetAttributes("desktop"),null!=this.$navigationMenu&&this.$navigationToggle.removeEventListener("click",this.$navigationToggle.boundMenuClick,!0),null!=this.$searchMenu&&this.$searchToggle.removeEventListener("click",this.$searchToggle.boundSearchClick,!0)},o.prototype.menuItemClick=function(e){let t=e.target.getAttribute("aria-controls");(null==t?(t=e.target.parentNode.getAttribute("aria-controls"),e.target.parentNode):e.target).classList.toggle("lbcamden-header__open-button"),this.$module.querySelectorAll(".lbcamden-header__navigation-second-toggle-button:not([aria-controls="+t+"])").forEach(e=>e.classList.remove("lbcamden-header__open-button"));e=document.getElementById(t);this.$module.querySelectorAll(".lbcamden-header__navigation-dropdown-menu:not(#"+t+")").forEach(e=>e.setAttribute("hidden",!0)),null!=document.getElementById(t).getAttribute("hidden")?document.getElementById(t).removeAttribute("hidden"):document.getElementById(t).setAttribute("hidden","true"),!0===this.mql.matches&&(this.$module.style.marginBottom=e.offsetHeight+"px"),null!=this.$searchMenu&&this.closeSearch(this.$searchToggle,this.$searchMenu)},o.prototype.setAttributes=function(e){"mobile"===e&&null!=this.$navigationMenu&&(this.$navigationToggle.removeAttribute("hidden"),this.$navigationToggle.setAttribute("aria-expanded",!1),this.$navigationMenu.setAttribute("hidden",!0)),null!=this.$searchMenu&&(this.$searchMenu.setAttribute("hidden",!0),this.$searchToggle.setAttribute("aria-expanded",!1),this.$searchToggle.setAttribute("aria-label","Show search menu"),this.$module.querySelector(".lbcamden-header__search-item-link").setAttribute("hidden",!0),this.$module.querySelector(".lbcamden-header__search-and-popular").removeAttribute("hidden"),this.$searchToggle.removeAttribute("hidden")),t(this.$menuButtons,function(e){e.querySelector(".lbcamden-header__navigation-item-link").setAttribute("hidden",!0),e.querySelector(".lbcamden-header__navigation-second-toggle-button").removeAttribute("hidden"),e.boundMenuItemClick=this.menuItemClick.bind(this),e.querySelector("button").addEventListener("click",e.boundMenuItemClick,!0)}.bind(this))},o.prototype.unsetAttributes=function(e){"mobile"===e&&(null!=this.$navigationMenu&&(this.$navigationToggle.setAttribute("hidden",!0),this.$navigationMenu.removeAttribute("hidden")),null!=this.$searchMenu&&(this.$searchToggle.setAttribute("hidden",!0),this.$searchMenu.removeAttribute("hidden"))),this.$module.style.marginBottom="0px",this.searchOpen=!1,this.menuOpen=!1,null!=this.$navigationMenu&&this.closeDesktopMenus(),null!=this.$searchMenu&&this.$searchToggle.classList.remove("lbcamden-header__open-button"),t(this.$menuButtons,function(e){e.querySelector("button").removeEventListener("click",e.boundMenuItemClick,!0)})},o.prototype.handleMenuButtonClick=function(){!0===this.menuOpen?this.closeMenu(this.$navigationToggle,this.$navigationMenu):this.openMenu(this.$navigationToggle,this.$navigationMenu)},o.prototype.handleSearchButtonClick=function(){!0===this.searchOpen?(this.closeSearch(this.$searchToggle,this.$searchMenu),!0===this.mql.matches&&(this.$module.style.marginBottom="0")):(this.openSearch(this.$searchToggle,this.$searchMenu),!0===this.mql.matches&&(this.$module.style.marginBottom=this.$searchMenu.offsetHeight-10+"px"))},o.prototype.openMenu=function(e,t){this.menuOpen=!0,e.classList.add("lbcamden-header__open-button"),e.setAttribute("aria-expanded",!0),e.setAttribute("aria-label","Hide navigation menu"),e.classList.add("lbcamden-header__open-button"),t.removeAttribute("hidden"),null!=this.$searchMenu&&this.closeSearch(this.$searchToggle,this.$searchMenu)},o.prototype.closeMenu=function(e,t){this.menuOpen=!1,this.$module.style.marginBottom="0px",null!=this.$navigationMenu&&(e.classList.remove("lbcamden-header__open-button"),e.setAttribute("aria-expanded",!1),e.setAttribute("aria-label","Show navigation menu"),e.classList.remove("lbcamden-header__open-button"),t.setAttribute("hidden",!0))},o.prototype.closeDesktopMenus=function(){this.$module.querySelectorAll(".lbcamden-header__navigation-dropdown-menu").forEach(e=>e.setAttribute("hidden",!0))},o.prototype.openSearch=function(e,t){this.searchOpen=!0,e.setAttribute("aria-expanded",!0),e.setAttribute("aria-label","Hide navigation menu"),this.$module.querySelectorAll(".lbcamden-header__open-button").forEach(e=>e.classList.remove("lbcamden-header__open-button")),e.classList.add("lbcamden-header__open-button"),t.removeAttribute("hidden"),!0!==this.mql.matches?this.closeMenu(this.$navigationToggle,this.$navigationMenu):this.closeDesktopMenus()},o.prototype.closeSearch=function(e,t){this.searchOpen=!1,e.setAttribute("aria-expanded",!1),e.setAttribute("aria-label","Show navigation menu"),e.classList.remove("lbcamden-header__open-button"),t.setAttribute("hidden",!0)},e.initAll=function(e){t((e="undefined"!=typeof(e=void 0!==e?e:{}).scope?e.scope:document).querySelectorAll('[data-module="lbcamden-header"]'),function(e){new o(e).init()}),t(e=e.querySelectorAll('[data-module="lbcamden-button"]'),function(e){new i(e).init()})},e.LBCamdenButton=i,e.LBCamdenHeader=o});
